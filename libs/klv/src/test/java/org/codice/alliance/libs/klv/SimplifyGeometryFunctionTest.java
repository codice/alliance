/**
 * Copyright (c) Codice Foundation
 * <p/>
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser
 * General Public License as published by the Free Software Foundation, either version 3 of the
 * License, or any later version.
 * <p/>
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without
 * even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details. A copy of the GNU Lesser General Public License
 * is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 */
package org.codice.alliance.libs.klv;

import static org.hamcrest.Matchers.is;
import static org.hamcrest.Matchers.notNullValue;
import static org.hamcrest.Matchers.nullValue;
import static org.junit.Assert.assertThat;
import static org.mockito.Mockito.mock;
import static org.mockito.Mockito.verify;

import org.hamcrest.Matchers;
import org.junit.Before;
import org.junit.Test;

import com.vividsolutions.jts.geom.Geometry;
import com.vividsolutions.jts.io.ParseException;
import com.vividsolutions.jts.io.WKTReader;

public class SimplifyGeometryFunctionTest {

    private static final String REALLY_LONG_LINESTRING =
            "LINESTRING (64.396706 31.709187, 64.396706 31.709187, 64.396717 31.709187, 64.396749 31.709196, 64.396749 31.709196, 64.396759 31.709205, 64.396759 31.709205, 64.396759 31.709205, 64.39677 31.709205, 64.39677 31.709205, 64.396781 31.709204, 64.396781 31.709204, 64.396781 31.709204, 64.396781 31.709204, 64.396781 31.709204, 64.396759 31.709205, 64.396759 31.709196, 64.396759 31.709196, 64.396759 31.709196, 64.396759 31.709196, 64.396717 31.709187, 64.396717 31.709187, 64.396717 31.709187, 64.396717 31.709178, 64.396717 31.709178, 64.396717 31.709178, 64.396717 31.709169, 64.396717 31.709169, 64.396717 31.709169, 64.396717 31.709169, 64.396717 31.709169, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709142, 64.396695 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396695 31.709151, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709178, 64.396696 31.709187, 64.396696 31.709187, 64.396706 31.709187, 64.396706 31.709187, 64.396706 31.709187, 64.396706 31.709187, 64.396706 31.709187, 64.396728 31.709205, 64.396728 31.709205, 64.396728 31.709205, 64.396728 31.709205, 64.396728 31.709205, 64.396738 31.709205, 64.396738 31.709205, 64.396738 31.709205, 64.396738 31.709205, 64.396738 31.709205, 64.396728 31.709196, 64.396738 31.709196, 64.396738 31.709196, 64.396738 31.709196, 64.396738 31.709196, 64.396738 31.709196, 64.396728 31.709187, 64.396728 31.709187, 64.396728 31.709187, 64.396717 31.709169, 64.396717 31.70916, 64.396717 31.70916, 64.396706 31.709151, 64.396706 31.709151, 64.396685 31.709142, 64.396685 31.709133, 64.396685 31.709133, 64.396685 31.709133, 64.396674 31.709133, 64.396674 31.709115, 64.396674 31.709115, 64.396663 31.709116, 64.396663 31.709116, 64.396663 31.709116, 64.396663 31.709116, 64.396663 31.709116, 64.396663 31.709116, 64.396653 31.709116, 64.396653 31.709116, 64.396653 31.709116, 64.396653 31.709116, 64.396653 31.709116, 64.396653 31.709116, 64.396653 31.709116, 64.396684 31.709115, 64.396684 31.709124, 64.396684 31.709124, 64.396684 31.709124, 64.396684 31.709124, 64.396684 31.709124, 64.396684 31.709124, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396674 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396664 31.709161, 64.396664 31.709161, 64.396664 31.709161, 64.396664 31.709161, 64.396664 31.709161, 64.396653 31.70917, 64.396653 31.70917, 64.396653 31.70917, 64.396653 31.70917, 64.396653 31.70917, 64.396643 31.709161, 64.396643 31.709161, 64.396643 31.709161, 64.396643 31.709161, 64.396643 31.709161, 64.396643 31.709161, 64.396653 31.709143, 64.396653 31.709143, 64.396653 31.709143, 64.396653 31.709143, 64.396653 31.709143, 64.396653 31.709143, 64.396653 31.709134, 64.396653 31.709134, 64.396653 31.709134, 64.396653 31.709134, 64.396653 31.709134, 64.396653 31.709134, 64.396653 31.709134, 64.396653 31.709134, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709125, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396674 31.709133, 64.396674 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.709169, 64.396696 31.70916, 64.396696 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396664 31.709143, 64.396664 31.709143, 64.396664 31.709143, 64.396664 31.709143, 64.396664 31.709143, 64.396664 31.709143, 64.396664 31.709143, 64.396653 31.709143, 64.396653 31.709134, 64.396642 31.709125, 64.396642 31.709125, 64.396642 31.709125, 64.396642 31.709125, 64.396642 31.709125, 64.396642 31.709125, 64.396642 31.709125, 64.396642 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396653 31.709125, 64.396663 31.709134, 64.396674 31.709133, 64.396674 31.709133, 64.396674 31.709133, 64.396674 31.709133, 64.396674 31.709133, 64.396674 31.709133, 64.396674 31.709133, 64.396674 31.709133, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396663 31.709134, 64.396664 31.709143, 64.396664 31.709143, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.709169, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396675 31.709169, 64.396664 31.70917, 64.396664 31.709179, 64.396664 31.709179, 64.396664 31.709179, 64.396664 31.709179, 64.396664 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396695 31.709142, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396695 31.709151, 64.396695 31.709151, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396716 31.709133, 64.396716 31.709133, 64.396716 31.709133, 64.396727 31.709133, 64.396727 31.709133, 64.396727 31.709133, 64.396727 31.709133, 64.396748 31.709133, 64.396748 31.709133, 64.396748 31.709133, 64.396748 31.709133, 64.396737 31.709133, 64.396737 31.709133, 64.396716 31.709133, 64.396716 31.709133, 64.396716 31.709133, 64.396716 31.709133, 64.396716 31.709133, 64.396716 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396706 31.709133, 64.396705 31.709124, 64.396695 31.709124, 64.396695 31.709124, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709151, 64.396695 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396706 31.709151, 64.396706 31.709151, 64.396695 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396685 31.70916, 64.396685 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396695 31.709151, 64.396695 31.709151, 64.396717 31.70916, 64.396717 31.70916, 64.396716 31.709151, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.70916, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396717 31.709169, 64.396717 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396695 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709142, 64.396685 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.398244 31.706879, 64.398244 31.706879, 64.398244 31.706879, 64.398244 31.706879, 64.398244 31.706879, 64.398234 31.706879, 64.398234 31.706879, 64.398234 31.706879, 64.398234 31.706879, 64.398234 31.706879, 64.398234 31.706888, 64.398234 31.706897, 64.398234 31.706897, 64.398234 31.706897, 64.398234 31.706897, 64.398234 31.706897, 64.398234 31.706897, 64.398234 31.706897, 64.398234 31.706897, 64.398244 31.706888, 64.398234 31.706879, 64.398234 31.706879, 64.398234 31.706879, 64.398234 31.706879, 64.398234 31.706879, 64.398244 31.706879, 64.398255 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398254 31.706861, 64.398254 31.706861, 64.398254 31.706861, 64.398254 31.706852, 64.398254 31.706852, 64.398254 31.706852, 64.398254 31.706852, 64.398254 31.706852, 64.398254 31.706852, 64.398254 31.706852, 64.398244 31.706852, 64.398244 31.706852, 64.398244 31.706852, 64.398244 31.706852, 64.398244 31.706852, 64.398244 31.706852, 64.398244 31.706852, 64.398244 31.706843, 64.398233 31.706843, 64.398233 31.706843, 64.398233 31.706843, 64.398233 31.706852, 64.398233 31.706852, 64.398223 31.706843, 64.398223 31.706843, 64.398223 31.706843, 64.398223 31.706843, 64.398223 31.706843, 64.398223 31.706843, 64.398223 31.706843, 64.398212 31.706843, 64.398201 31.706843, 64.398201 31.706843, 64.398201 31.706843, 64.398201 31.706843, 64.398201 31.706843, 64.398201 31.706843, 64.398201 31.706843, 64.398201 31.706843, 64.398223 31.706843, 64.398212 31.706843, 64.398212 31.706843, 64.398212 31.706852, 64.398212 31.706852, 64.398212 31.706852, 64.398212 31.706852, 64.398212 31.706852, 64.398201 31.706852, 64.398212 31.706852, 64.398212 31.706861, 64.398212 31.706861, 64.398212 31.706861, 64.398212 31.706861, 64.398212 31.706861, 64.398212 31.706861, 64.398202 31.706861, 64.398202 31.706861, 64.398223 31.70687, 64.398223 31.70687, 64.398223 31.70687, 64.398223 31.70687, 64.398223 31.70687, 64.398223 31.706879, 64.398212 31.706879, 64.398212 31.706879, 64.398202 31.706879, 64.398202 31.706879, 64.39816 31.706889, 64.39816 31.70688, 64.398149 31.70688, 64.398149 31.70688, 64.398149 31.70688, 64.39817 31.70688, 64.39817 31.70688, 64.39817 31.706871, 64.39816 31.706871, 64.39816 31.706871, 64.398149 31.706862, 64.398149 31.706862, 64.398149 31.706853, 64.398149 31.706844, 64.398138 31.706817, 64.398138 31.706808, 64.398148 31.706808, 64.398148 31.706808, 64.398148 31.706799, 64.398158 31.706781, 64.398158 31.706781, 64.398158 31.706781, 64.398158 31.706781, 64.398158 31.706781, 64.398169 31.706772, 64.398158 31.706781, 64.398158 31.706781, 64.398158 31.706781, 64.398158 31.706781, 64.398169 31.70679, 64.398169 31.70679, 64.398169 31.70679, 64.398169 31.706799, 64.398169 31.706799, 64.398169 31.706808, 64.398169 31.706817, 64.398169 31.706817, 64.398169 31.706817, 64.398169 31.706817, 64.39817 31.706844, 64.39817 31.706844, 64.398159 31.706844, 64.398159 31.706844, 64.398159 31.706853, 64.398149 31.706862, 64.398149 31.706862, 64.398149 31.706862, 64.398149 31.706862, 64.398149 31.706862, 64.398149 31.706862, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398117 31.706853, 64.398117 31.706853, 64.398128 31.706853, 64.398128 31.706853, 64.398138 31.706844, 64.398138 31.706844, 64.398138 31.706844, 64.398138 31.706835, 64.398138 31.706835, 64.398149 31.706835, 64.398149 31.706835, 64.398149 31.706835, 64.398149 31.706835, 64.398138 31.706844, 64.398138 31.706844, 64.398138 31.706844, 64.398138 31.706844, 64.398138 31.706844, 64.398149 31.706835, 64.398149 31.706835, 64.398149 31.706844, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706862, 64.398128 31.706862, 64.398128 31.706862, 64.398128 31.706853, 64.398128 31.706853, 64.398128 31.706862, 64.398128 31.706862, 64.398128 31.706862, 64.398128 31.706862, 64.398128 31.706862, 64.398117 31.706862, 64.398117 31.706862, 64.398117 31.706871, 64.398117 31.706871, 64.398117 31.706871, 64.398117 31.706871, 64.398117 31.706871, 64.398118 31.70688, 64.398118 31.70688, 64.398118 31.70688, 64.398118 31.70688, 64.398118 31.70688, 64.398118 31.706889, 64.398118 31.706889, 64.398118 31.706898, 64.398118 31.706898, 64.398118 31.706898, 64.398086 31.706908, 64.398086 31.706908, 64.398086 31.706908, 64.398086 31.706908, 64.398065 31.706899, 64.398065 31.706908, 64.398065 31.706917, 64.398076 31.706926, 64.398076 31.706935, 64.398087 31.706944, 64.398087 31.706944, 64.398087 31.706953, 64.398087 31.706953, 64.398098 31.706971, 64.398087 31.706971, 64.398087 31.706971, 64.398087 31.706971, 64.398087 31.70698, 64.398087 31.70698, 64.398087 31.70698, 64.398088 31.707016, 64.398088 31.707016, 64.398088 31.707016, 64.398088 31.707016, 64.398077 31.707016, 64.398078 31.707025, 64.398067 31.707043, 64.398067 31.707043, 64.398057 31.707043, 64.398056 31.707025, 64.398056 31.707025, 64.398056 31.707025, 64.398046 31.707026, 64.398046 31.707026, 64.398035 31.707026, 64.398014 31.707008, 64.398003 31.707008, 64.398003 31.707008, 64.398003 31.706999, 64.397993 31.706999, 64.397993 31.706999, 64.397993 31.706999, 64.397993 31.706999, 64.397982 31.706972, 64.397982 31.706972, 64.397971 31.706972, 64.397971 31.706972, 64.397971 31.706963, 64.397971 31.706963, 64.39796 31.706954, 64.397961 31.706972, 64.397961 31.706963, 64.397961 31.706963, 64.397961 31.706963, 64.397961 31.706963, 64.397961 31.706963, 64.39796 31.706954, 64.39796 31.706954, 64.39796 31.706954, 64.39796 31.706954, 64.39796 31.706954, 64.39796 31.706954, 64.39795 31.706945, 64.39795 31.706945, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706954, 64.39795 31.706963, 64.39795 31.706963, 64.39795 31.706963, 64.39795 31.706963, 64.39795 31.706963, 64.397961 31.706963, 64.397961 31.706963, 64.397961 31.706963, 64.39796 31.706954, 64.39796 31.706954, 64.39796 31.706954, 64.39796 31.706954, 64.397971 31.706954, 64.397971 31.706954, 64.397971 31.706954, 64.397971 31.706954, 64.397971 31.706954, 64.397971 31.706954, 64.397971 31.706945, 64.397971 31.706945, 64.397971 31.706945, 64.397971 31.706954, 64.397971 31.706954, 64.397971 31.706954, 64.397961 31.706963, 64.397961 31.706963, 64.397961 31.706972, 64.397961 31.706972, 64.397961 31.706972, 64.397961 31.706981, 64.397971 31.706972, 64.397971 31.706981, 64.397971 31.706981, 64.397971 31.706981, 64.397971 31.706981, 64.397971 31.706981, 64.397971 31.706981, 64.397982 31.70699, 64.397982 31.70699, 64.397982 31.70699, 64.397982 31.70699, 64.397982 31.70699, 64.397982 31.70699, 64.397982 31.70699, 64.397982 31.70699, 64.397982 31.70699, 64.397983 31.707026, 64.397983 31.707026, 64.397983 31.707026, 64.397983 31.707026, 64.397983 31.707026, 64.397972 31.707026, 64.397972 31.707026, 64.397972 31.707026, 64.397972 31.707026, 64.397972 31.707017, 64.397961 31.707017, 64.397961 31.707017, 64.397961 31.707017, 64.397961 31.707017, 64.397961 31.707017, 64.39794 31.706991, 64.39794 31.706991, 64.39794 31.706991, 64.397929 31.706991, 64.397929 31.706991, 64.397929 31.706982, 64.397929 31.706973, 64.397918 31.706973, 64.397918 31.706964, 64.397918 31.706964, 64.397918 31.706964, 64.397918 31.706955, 64.397918 31.706955, 64.397918 31.706955, 64.397918 31.706946, 64.397907 31.706946, 64.397907 31.706937, 64.397907 31.706928, 64.397907 31.706928, 64.397907 31.706928, 64.397907 31.706919, 64.397907 31.706919, 64.397907 31.706919, 64.397907 31.70691, 64.397907 31.70691, 64.397907 31.706901, 64.397896 31.706892, 64.397896 31.706892, 64.397896 31.706883, 64.397896 31.706883, 64.397896 31.706883, 64.397896 31.706874, 64.397896 31.706874, 64.397896 31.706865, 64.397896 31.706865, 64.397896 31.706856, 64.397896 31.706856, 64.396712 31.708141, 64.396712 31.708177, 64.396703 31.708276, 64.396704 31.708348, 64.396705 31.708375, 64.396705 31.708411, 64.396706 31.708475, 64.396707 31.708502, 64.396697 31.708565, 64.396698 31.708619, 64.396698 31.708646, 64.396699 31.708673, 64.396699 31.708691, 64.396699 31.708718, 64.3967 31.708745, 64.3967 31.708763, 64.396701 31.70879, 64.396701 31.708808, 64.396701 31.708835, 64.396691 31.708854, 64.396691 31.708872, 64.396692 31.708899, 64.396692 31.708935, 64.396692 31.708953, 64.396693 31.708971, 64.396693 31.708998, 64.396693 31.709016, 64.396694 31.709043, 64.396684 31.70907, 64.396683 31.709061, 64.396684 31.70907, 64.396684 31.709079, 64.396684 31.709088, 64.396684 31.709097, 64.396684 31.709106, 64.396684 31.709115, 64.396684 31.709115, 64.396684 31.709124, 64.396685 31.709133, 64.396685 31.709133, 64.396674 31.709142, 64.396674 31.709142, 64.396674 31.709151, 64.396674 31.70916, 64.396674 31.70916, 64.396685 31.70916, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396674 31.709151, 64.396674 31.709151, 64.396674 31.709142, 64.396674 31.709133, 64.396674 31.709124, 64.396674 31.709124, 64.396674 31.709124, 64.396674 31.709124, 64.396674 31.709124, 64.396674 31.709115, 64.396674 31.709115, 64.396674 31.709115, 64.396684 31.709115, 64.396684 31.709115, 64.396684 31.709115, 64.396684 31.709115, 64.396684 31.709115, 64.396684 31.709115, 64.396674 31.709124, 64.396684 31.709124, 64.396684 31.709124, 64.396684 31.709124, 64.396695 31.709133, 64.396695 31.709133, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396706 31.709142, 64.396706 31.709142, 64.396706 31.709142, 64.396706 31.709142, 64.396706 31.709142, 64.396706 31.709151, 64.396706 31.709151, 64.396706 31.709151, 64.396706 31.709151, 64.396706 31.709151, 64.396706 31.709142, 64.396716 31.709142, 64.396716 31.709142, 64.396716 31.709151, 64.396716 31.709151, 64.396716 31.709151, 64.396716 31.709151, 64.396716 31.709151, 64.396716 31.709151, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.70916, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709178, 64.396717 31.70916, 64.396717 31.70916, 64.396717 31.709169, 64.396717 31.709169, 64.396717 31.709169, 64.396717 31.709169, 64.396706 31.709169, 64.396717 31.709169, 64.396717 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396706 31.709169, 64.396717 31.709178, 64.396717 31.709178, 64.396717 31.709178, 64.396717 31.709178, 64.396717 31.709178, 64.396717 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396706 31.709178, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396706 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396674 31.70916, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396675 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.709169, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396685 31.70916, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396675 31.709179, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709178, 64.396685 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.709169, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396696 31.70916, 64.396695 31.709151, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709151, 64.396685 31.709142, 64.396685 31.709142, 64.396685 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.396695 31.709142, 64.398806 31.707044, 64.398806 31.707044, 64.398806 31.707044, 64.398806 31.707044, 64.398806 31.707044, 64.398816 31.707044, 64.398816 31.707044, 64.398816 31.707044, 64.398816 31.707044, 64.398816 31.707044, 64.398827 31.707044, 64.398827 31.707044, 64.398827 31.707035, 64.398827 31.707035, 64.398827 31.707035, 64.398827 31.707044, 64.398827 31.707044, 64.398838 31.707044, 64.398838 31.707044, 64.398838 31.707044, 64.398838 31.707044, 64.398837 31.707035, 64.398838 31.707044, 64.398838 31.707044, 64.398838 31.707044, 64.398838 31.707044, 64.398838 31.707044, 64.398848 31.707044, 64.398848 31.707044, 64.398848 31.707044, 64.398848 31.707053, 64.398848 31.707053, 64.398848 31.707053, 64.398848 31.707053, 64.398848 31.707053, 64.398848 31.707053, 64.398848 31.707053, 64.398848 31.707053, 64.398848 31.707062, 64.398859 31.707071, 64.398859 31.707071, 64.398859 31.707071, 64.398859 31.707071, 64.39887 31.707071, 64.39887 31.707071, 64.39887 31.707071, 64.39887 31.707071, 64.39888 31.70707, 64.39888 31.70707, 64.39888 31.70707, 64.39887 31.707071, 64.39887 31.707071, 64.39887 31.707071, 64.39887 31.707071, 64.398848 31.707053, 64.398848 31.707053, 64.398838 31.707053, 64.398838 31.707044, 64.398838 31.707044, 64.398827 31.707044, 64.398785 31.707026, 64.398774 31.707027, 64.398774 31.707018, 64.398774 31.707018, 64.398763 31.707018, 64.398763 31.707009, 64.398753 31.707009, 64.398753 31.707009, 64.398752 31.707, 64.398742 31.707, 64.398742 31.707, 64.398752 31.707, 64.398752 31.706991, 64.398752 31.706991, 64.398742 31.706991, 64.398742 31.707, 64.398752 31.706991, 64.398752 31.706991, 64.398752 31.706991, 64.398752 31.706982, 64.398752 31.706982, 64.398752 31.706982, 64.398752 31.706982, 64.398752 31.706973, 64.398752 31.706973, 64.398752 31.706973, 64.398752 31.706973, 64.398752 31.706973, 64.398752 31.706973, 64.398752 31.706973, 64.398752 31.706973, 64.398752 31.706964, 64.398752 31.706964, 64.398752 31.706964, 64.398752 31.706964, 64.398752 31.706955, 64.398752 31.706955, 64.398762 31.706945, 64.398762 31.706945, 64.398762 31.706945, 64.398773 31.706945, 64.398773 31.706945, 64.398773 31.706954, 64.398783 31.706954, 64.398783 31.706954, 64.398794 31.706954, 64.398794 31.706954, 64.398794 31.706954, 64.398794 31.706954, 64.398794 31.706954, 64.398805 31.706963, 64.398805 31.706963, 64.398805 31.706963, 64.398805 31.706963, 64.398815 31.706972, 64.398815 31.706972, 64.398815 31.706972, 64.398805 31.706972, 64.398805 31.706972, 64.398815 31.706972, 64.398805 31.706972, 64.398805 31.706972, 64.398794 31.706963, 64.398784 31.706963, 64.398773 31.706954, 64.398773 31.706954, 64.398762 31.706954, 64.398752 31.706946, 64.398741 31.706937, 64.39873 31.706937, 64.39872 31.706928, 64.398709 31.706928, 64.398698 31.706919, 64.398677 31.70691, 64.398667 31.70691, 64.398656 31.706902, 64.398635 31.706902, 64.398635 31.706902, 64.398614 31.706893, 64.398593 31.706893, 64.398571 31.706884, 64.398561 31.706885, 64.39854 31.706876, 64.398508 31.706876, 64.398487 31.706876, 64.398476 31.706867, 64.398455 31.706868, 64.398434 31.706868, 64.398413 31.706868, 64.398392 31.706868, 64.398381 31.706868, 64.398371 31.706869, 64.39836 31.706869, 64.398339 31.706869, 64.398328 31.706869, 64.398318 31.706869, 64.398307 31.706869, 64.398297 31.706869, 64.398297 31.70686, 64.398297 31.70686, 64.398286 31.70686, 64.398276 31.706861, 64.398265 31.706861, 64.398265 31.70687, 64.398265 31.70687, 64.398255 31.70687, 64.398244 31.70687, 64.398244 31.70687, 64.398244 31.706861, 64.398244 31.706861, 64.398244 31.706861, 64.398233 31.706861, 64.398233 31.706861, 64.398233 31.70687, 64.398233 31.70687, 64.398233 31.70687, 64.398233 31.70687, 64.398244 31.70687, 64.398244 31.70687, 64.398244 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398255 31.70687, 64.398265 31.706861, 64.398265 31.706861, 64.398276 31.70687, 64.398286 31.70686, 64.398286 31.70686, 64.398276 31.706861, 64.398275 31.706852, 64.398275 31.706852, 64.398275 31.706852, 64.398275 31.706852, 64.398275 31.706852, 64.398275 31.706843, 64.398275 31.706843, 64.398275 31.706843, 64.398275 31.706843, 64.398275 31.706834, 64.398275 31.706834, 64.398275 31.706834, 64.398275 31.706834, 64.398275 31.706834, 64.398254 31.706834, 64.398254 31.706834, 64.398254 31.706834, 64.398254 31.706834, 64.398265 31.706834, 64.398265 31.706834, 64.398265 31.706834, 64.398265 31.706834, 64.398265 31.706834, 64.398275 31.706834, 64.398275 31.706834, 64.398275 31.706834, 64.398275 31.706834, 64.398275 31.706834, 64.398286 31.706842, 64.398286 31.706842, 64.398286 31.706842, 64.398286 31.706842, 64.398296 31.706833, 64.398296 31.706833, 64.398296 31.706833, 64.398296 31.706842, 64.398296 31.706842, 64.398307 31.706824, 64.398307 31.706824, 64.398307 31.706833, 64.398296 31.706833, 64.398296 31.706842, 64.398275 31.706852, 64.398275 31.706852, 64.398275 31.706852, 64.398275 31.706852, 64.398265 31.706861, 64.398265 31.70687, 64.398265 31.706879, 64.398265 31.706879, 64.398265 31.706879, 64.398255 31.706879, 64.398255 31.706897, 64.398255 31.706897, 64.398255 31.706897, 64.398255 31.706897, 64.398255 31.706897, 64.398245 31.706906, 64.398245 31.706906, 64.398245 31.706906, 64.398245 31.706906, 64.398245 31.706906, 64.398245 31.706906, 64.398245 31.706906, 64.398245 31.706906, 64.398234 31.706906, 64.398234 31.706897, 64.398234 31.706897, 64.398234 31.706888, 64.398223 31.706888, 64.398223 31.706888, 64.398233 31.706861, 64.398233 31.706852, 64.398233 31.706852, 64.398223 31.706843, 64.398223 31.706843, 64.398212 31.706834, 64.398212 31.706825, 64.398212 31.706825, 64.398212 31.706825, 64.398201 31.706825, 64.398201 31.706825, 64.398201 31.706825, 64.398201 31.706825, 64.398201 31.706825, 64.398201 31.706825, 64.398201 31.706834, 64.398201 31.706834, 64.398201 31.706834, 64.398212 31.706843, 64.398212 31.706843, 64.398212 31.706843, 64.398212 31.706852, 64.398223 31.70687, 64.398223 31.70687, 64.398223 31.70687, 64.398212 31.70687, 64.398212 31.706879, 64.398202 31.706916, 64.398202 31.706916, 64.398202 31.706916, 64.398202 31.706916, 64.398192 31.706925, 64.398182 31.706925, 64.398182 31.706925, 64.398182 31.706925, 64.398182 31.706925, 64.398182 31.706925, 64.398181 31.706916, 64.398171 31.706925, 64.398182 31.706925, 64.398182 31.706925, 64.398181 31.706916, 64.398181 31.706916, 64.398181 31.706907, 64.398181 31.706907, 64.398181 31.706898, 64.398181 31.706898, 64.39816 31.70688, 64.39816 31.70688, 64.39816 31.706871, 64.398159 31.706862, 64.39817 31.706862, 64.39817 31.706853, 64.39817 31.706844, 64.39817 31.706835, 64.39818 31.706835, 64.398222 31.706816, 64.398233 31.706807, 64.398232 31.706798, 64.398232 31.706789, 64.398232 31.70678, 64.398242 31.706771, 64.398242 31.706762, 64.398242 31.706762, 64.398253 31.706753, 64.398251 31.706662, 64.398251 31.706662, 64.398251 31.706653, 64.398262 31.706644, 64.398262 31.706644, 64.398272 31.706635, 64.398282 31.706617, 64.398282 31.706608, 64.398293 31.706608, 64.398293 31.706617, 64.398303 31.706617, 64.398303 31.706617, 64.398303 31.706617, 64.398314 31.706626, 64.398314 31.706626, 64.398314 31.706626, 64.398304 31.706662, 64.398304 31.706671, 64.398315 31.70668, 64.398315 31.70668, 64.398315 31.706689, 64.398306 31.706797, 64.398296 31.706815, 64.398296 31.706824, 64.398296 31.706833, 64.398297 31.70686, 64.398297 31.706869, 64.398297 31.706878, 64.398297 31.706887, 64.398297 31.706887, 64.398297 31.706896, 64.398297 31.706896, 64.398287 31.706897, 64.398287 31.706906, 64.398276 31.706879, 64.398265 31.706879, 64.398265 31.706879, 64.398265 31.706888, 64.398265 31.706888, 64.398265 31.706879, 64.398265 31.706879, 64.398255 31.706879, 64.398255 31.706879, 64.398255 31.706879, 64.398244 31.70687, 64.398244 31.70687, 64.398244 31.70687, 64.398244 31.70687, 64.398244 31.70687, 64.398233 31.70687)";

    private SimplifyGeometryFunction simplifyGeometryFunction;

    private WKTReader wktReader;

    @Before
    public void setup() {
        simplifyGeometryFunction = new SimplifyGeometryFunction();
        wktReader = new WKTReader();
    }

    @Test
    public void testApply() throws ParseException {
        Geometry originalGeometry = wktReader.read(REALLY_LONG_LINESTRING);
        Geometry transformedGeometry = simplifyGeometryFunction.apply(originalGeometry);
        assertThat(transformedGeometry.getCoordinates().length,
                Matchers.lessThan(originalGeometry.getCoordinates().length));
    }

    @Test
    public void testApplyToLineString() throws ParseException {
        String lineStringWkt = "LINESTRING ( 0 0, 0.01 0.01, 0.05 0.05 )";
        String expectedLineStringWkt = "LINESTRING ( 0 0, 0.05 0.05 )";
        simplifyGeometryFunction.setDistanceTolerance(0.01);
        assertThat(simplifyGeometryFunction.apply(wktReader.read(lineStringWkt))
                        .norm(),
                is(wktReader.read(expectedLineStringWkt)
                        .norm()));
    }

    @Test
    public void testApplyNullArg() {
        Geometry result = simplifyGeometryFunction.apply(null);
        assertThat(result, nullValue());
    }

    @Test
    public void testCtorDouble() {
        double value = 10;
        SimplifyGeometryFunction function = new SimplifyGeometryFunction(value);
        assertThat(function.getDistanceTolerance()
                .get(), Matchers.closeTo(value, 0.1));
    }

    @Test
    public void testToString() {
        assertThat(simplifyGeometryFunction.toString(), notNullValue());
    }

    @Test
    public void testAccept() {
        GeometryOperator.Visitor visitor = mock(GeometryOperator.Visitor.class);
        simplifyGeometryFunction.accept(visitor);
        verify(visitor).visit(simplifyGeometryFunction);
    }

}
